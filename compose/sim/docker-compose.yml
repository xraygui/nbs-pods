version: '3'

networks:
  bluesky-services_bluesky:
    external: true

services:
  nbs-sim:
    image: nbs_sim:latest
    volumes:
      - ${NBSDIR}:/usr/local/src/xraygui
      - ../../config/ipython:/usr/local/share/ipython
    command: >
      bash -c "
        pip3 install -e /usr/local/src/xraygui/nbs-core &&
        pip3 install -e /usr/local/src/xraygui/nbs-bl &&
        pip3 install -e /usr/local/src/xraygui/nbs-sim &&
        nbs-sim --startup-dir /usr/local/share/ipython/profile_default/startup --list-pvs
      "
    networks:
      - bluesky-services_bluesky
